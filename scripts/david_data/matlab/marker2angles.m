function  [alpha, delta, tq] = marker2angles( h5file, deltacase)
% [alpha, delta, tq] = marker2angles( h5file, deltacase )
%   
% Extract angle of attack and flap deflection angle from optical position 
% measurements stored in HDF5 file. 
% 
% deltacase: must be 24, 14, 11, 8, 0, or -4

    % non-dimensional airfoil coordinates, delta = 14 degree
    pp14 = [     0.99998    -0.03608
                 0.99459    -0.03465
                 0.98735    -0.03254
                 0.97908    -0.02987
                 0.96991    -0.02664
                 0.96009    -0.02289
                 0.94985    -0.01872
                 0.93940    -0.01425
                 0.92891    -0.00955
                 0.91846    -0.00464
                 0.90811     0.00045
                 0.89785     0.00572
                 0.88764     0.01110
                 0.87722     0.01653
                 0.86708     0.02154
                 0.86154     0.02408
                 0.85562     0.02665
                 0.84972     0.02912
                 0.84592     0.03067
                 0.83432     0.03530
                 0.82237     0.03998
                 0.81033     0.04458
                 0.79842     0.04893
                 0.78669     0.05308
                 0.77510     0.05700
                 0.76360     0.06069
                 0.75214     0.06415
                 0.74068     0.06738
                 0.72917     0.07039
                 0.71756     0.07320
                 0.70582     0.07582
                 0.69393     0.07828
                 0.68190     0.08058
                 0.66978     0.08273
                 0.65756     0.08474
                 0.64527     0.08660
                 0.63291     0.08833
                 0.62050     0.08992
                 0.60803     0.09139
                 0.59552     0.09272
                 0.58297     0.09394
                 0.57037     0.09503
                 0.55773     0.09600
                 0.54507     0.09686
                 0.53237     0.09761
                 0.51964     0.09825
                 0.50688     0.09879
                 0.49411     0.09922
                 0.48131     0.09956
                 0.46850     0.09979
                 0.45567     0.09993
                 0.44284     0.09997
                 0.43000     0.09991
                 0.41717     0.09976
                 0.40433     0.09951
                 0.39150     0.09917
                 0.37868     0.09873
                 0.36586     0.09820
                 0.35306     0.09757
                 0.34027     0.09684
                 0.32751     0.09601
                 0.31477     0.09508
                 0.30204     0.09405
                 0.28935     0.09291
                 0.27669     0.09166
                 0.26405     0.09031
                 0.25146     0.08884
                 0.23892     0.08726
                 0.22642     0.08556
                 0.21397     0.08374
                 0.20158     0.08180
                 0.18925     0.07973
                 0.17701     0.07752
                 0.16484     0.07518
                 0.15276     0.07269
                 0.14079     0.07006
                 0.12896     0.06729
                 0.11728     0.06436
                 0.10581     0.06128
                 0.09459     0.05804
                 0.08370     0.05467
                 0.07324     0.05116
                 0.06334     0.04755
                 0.05412     0.04388
                 0.04574     0.04024
                 0.03834     0.03671
                 0.03198     0.03339
                 0.02663     0.03032
                 0.02217     0.02751
                 0.01846     0.02496
                 0.01536     0.02263
                 0.01276     0.02048
                 0.01057     0.01850
                 0.00872     0.01665
                 0.00713     0.01493
                 0.00578     0.01330
                 0.00463     0.01177
                 0.00364     0.01032
                 0.00281     0.00893
                 0.00210     0.00762
                 0.00151     0.00635
                 0.00103     0.00515
                 0.00064     0.00399
                 0.00035     0.00288
                 0.00015     0.00181
                 0.00004     0.00079
                 0.00000    -0.00020
                 0.00012    -0.00118
                 0.00036    -0.00220
                 0.00068    -0.00324
                 0.00109    -0.00431
                 0.00160    -0.00540
                 0.00223    -0.00651
                 0.00300    -0.00762
                 0.00391    -0.00872
                 0.00499    -0.00980
                 0.00626    -0.01084
                 0.00774    -0.01183
                 0.00942    -0.01279
                 0.01135    -0.01372
                 0.01355    -0.01464
                 0.01608    -0.01554
                 0.01901    -0.01646
                 0.02246    -0.01738
                 0.02656    -0.01833
                 0.03152    -0.01932
                 0.03755    -0.02038
                 0.04489    -0.02149
                 0.05365    -0.02263
                 0.06372    -0.02376
                 0.07480    -0.02482
                 0.08659    -0.02578
                 0.09880    -0.02663
                 0.11129    -0.02736
                 0.12396    -0.02800
                 0.13672    -0.02854
                 0.14954    -0.02898
                 0.16244    -0.02934
                 0.17544    -0.02961
                 0.18853    -0.02982
                 0.20166    -0.02998
                 0.21483    -0.03010
                 0.22804    -0.03016
                 0.24131    -0.03019
                 0.25461    -0.03019
                 0.26790    -0.03016
                 0.28121    -0.03010
                 0.29455    -0.03001
                 0.30791    -0.02990
                 0.32131    -0.02977
                 0.33472    -0.02963
                 0.34813    -0.02948
                 0.36153    -0.02932
                 0.37489    -0.02914
                 0.38826    -0.02894
                 0.40166    -0.02872
                 0.41509    -0.02848
                 0.42854    -0.02824
                 0.44200    -0.02801
                 0.45547    -0.02777
                 0.46895    -0.02754
                 0.48244    -0.02730
                 0.49592    -0.02707
                 0.50940    -0.02684
                 0.52287    -0.02660
                 0.53633    -0.02636
                 0.54979    -0.02612
                 0.56324    -0.02587
                 0.57668    -0.02561
                 0.59011    -0.02534
                 0.60354    -0.02507
                 0.61696    -0.02478
                 0.63039    -0.02448
                 0.64380    -0.02417
                 0.65722    -0.02386
                 0.67064    -0.02352
                 0.68406    -0.02318
                 0.69749    -0.02283
                 0.71091    -0.02247
                 0.72434    -0.02210
                 0.73776    -0.02172
                 0.75116    -0.02133
                 0.76453    -0.02092
                 0.77787    -0.02050
                 0.79117    -0.02006
                 0.80443    -0.01975
                 0.81764    -0.01958
                 0.83078    -0.01960
                 0.84396    -0.01995
                 0.84982    -0.02029
                 0.85622    -0.02084
                 0.86912    -0.02236
                 0.88180    -0.02414
                 0.89436    -0.02601
                 0.90677    -0.02787
                 0.91903    -0.02963
                 0.93110    -0.03125
                 0.94298    -0.03270
                 0.95464    -0.03393
                 0.96598    -0.03493
                 0.97669    -0.03573
                 0.98618    -0.03639
                 0.99402    -0.03699
                 0.99963    -0.03754 ];
             
    % non-dimensional airfoil coordinates, delta = 11 degree
    pp11 = [       1.000834     -0.2820643E-01
                   0.9953664     -0.2706870E-01
                   0.9880272     -0.2533222E-01
                   0.9796225     -0.2309929E-01
                   0.9703038     -0.2034781E-01
                   0.9602990     -0.1711978E-01
                   0.9498542     -0.1349818E-01
                   0.9391965     -0.9544980E-02
                   0.9285025     -0.5329520E-02
                   0.9178609     -0.8764828E-03
                   0.9073198      0.3771570E-02
                   0.8968695      0.8625149E-02
                   0.8865006      0.1369476E-01
                   0.8761211      0.1894518E-01
                   0.8688009      0.2253800E-01
                   0.8633500      0.2479000E-01
                   0.8589400      0.2648000E-01
                   0.8544400      0.2816000E-01
                   0.8499500      0.2982000E-01
                   0.8461200      0.3123000E-01
                   0.8344200      0.3557000E-01
                   0.8224100      0.4008000E-01
                   0.8103300      0.4460000E-01
                   0.7984300      0.4897000E-01
                   0.7867100      0.5312000E-01
                   0.7751200      0.5705000E-01
                   0.7636200      0.6075000E-01
                   0.7521600      0.6420000E-01
                   0.7407000      0.6743000E-01
                   0.7291800      0.7043000E-01
                   0.7175700      0.7323000E-01
                   0.7058300      0.7585000E-01
                   0.6939300      0.7830000E-01
                   0.6819100      0.8059000E-01
                   0.6697800      0.8273000E-01
                   0.6575600      0.8474000E-01
                   0.6452700      0.8660000E-01
                   0.6329100      0.8833000E-01
                   0.6205000      0.8992000E-01
                   0.6080300      0.9139000E-01
                   0.5955200      0.9272000E-01
                   0.5829700      0.9394000E-01
                   0.5703700      0.9503000E-01
                   0.5577300      0.9600000E-01
                   0.5450700      0.9686000E-01
                   0.5323700      0.9761000E-01
                   0.5196400      0.9825000E-01
                   0.5068800      0.9879000E-01
                   0.4941100      0.9922000E-01
                   0.4813100      0.9956000E-01
                   0.4685000      0.9979000E-01
                   0.4556700      0.9993000E-01
                   0.4428400      0.9997000E-01
                   0.4300000      0.9991000E-01
                   0.4171700      0.9976000E-01
                   0.4043300      0.9951000E-01
                   0.3915000      0.9917000E-01
                   0.3786800      0.9873000E-01
                   0.3658600      0.9820000E-01
                   0.3530600      0.9757000E-01
                   0.3402700      0.9684000E-01
                   0.3275100      0.9601000E-01
                   0.3147700      0.9508000E-01
                   0.3020400      0.9405000E-01
                   0.2893500      0.9291000E-01
                   0.2766900      0.9166000E-01
                   0.2640500      0.9031000E-01
                   0.2514600      0.8884000E-01
                   0.2389200      0.8726000E-01
                   0.2264200      0.8556000E-01
                   0.2139700      0.8374000E-01
                   0.2015800      0.8180000E-01
                   0.1892500      0.7973000E-01
                   0.1770100      0.7752000E-01
                   0.1648400      0.7518000E-01
                   0.1527600      0.7269000E-01
                   0.1407900      0.7006000E-01
                   0.1289600      0.6729000E-01
                   0.1172800      0.6436000E-01
                   0.1058100      0.6128000E-01
                   0.9459000E-01  0.5804000E-01
                   0.8370000E-01  0.5467000E-01
                   0.7324000E-01  0.5116000E-01
                   0.6334000E-01  0.4755000E-01
                   0.5412000E-01  0.4388000E-01
                   0.4574000E-01  0.4024000E-01
                   0.3834000E-01  0.3671000E-01
                   0.3198000E-01  0.3339000E-01
                   0.2663000E-01  0.3032000E-01
                   0.2217000E-01  0.2751000E-01
                   0.1846000E-01  0.2496000E-01
                   0.1536000E-01  0.2263000E-01
                   0.1276000E-01  0.2048000E-01
                   0.1057000E-01  0.1850000E-01
                   0.8720000E-02  0.1665000E-01
                   0.7130000E-02  0.1493000E-01
                   0.5780000E-02  0.1330000E-01
                   0.4630000E-02  0.1177000E-01
                   0.3640000E-02  0.1032000E-01
                   0.2810000E-02  0.8930000E-02
                   0.2100000E-02  0.7620000E-02
                   0.1510000E-02  0.6350000E-02
                   0.1030000E-02  0.5150000E-02
                   0.6400000E-03  0.3990000E-02
                   0.3500000E-03  0.2880000E-02
                   0.1500000E-03  0.1810000E-02
                   0.4000000E-04  0.7900000E-03
                    0.000000     -0.2000000E-03
                   0.1200000E-03 -0.1180000E-02
                   0.3600000E-03 -0.2200000E-02
                   0.6800000E-03 -0.3240000E-02
                   0.1090000E-02 -0.4310000E-02
                   0.1600000E-02 -0.5400000E-02
                   0.2230000E-02 -0.6510000E-02
                   0.3000000E-02 -0.7620000E-02
                   0.3910000E-02 -0.8720000E-02
                   0.4990000E-02 -0.9800000E-02
                   0.6260000E-02 -0.1084000E-01
                   0.7740000E-02 -0.1183000E-01
                   0.9420000E-02 -0.1279000E-01
                   0.1135000E-01 -0.1372000E-01
                   0.1355000E-01 -0.1464000E-01
                   0.1608000E-01 -0.1554000E-01
                   0.1901000E-01 -0.1646000E-01
                   0.2246000E-01 -0.1738000E-01
                   0.2656000E-01 -0.1833000E-01
                   0.3152000E-01 -0.1932000E-01
                   0.3755000E-01 -0.2038000E-01
                   0.4489000E-01 -0.2149000E-01
                   0.5365000E-01 -0.2263000E-01
                   0.6372000E-01 -0.2376000E-01
                   0.7480000E-01 -0.2482000E-01
                   0.8659000E-01 -0.2578000E-01
                   0.9880000E-01 -0.2663000E-01
                   0.1112900     -0.2736000E-01
                   0.1239600     -0.2800000E-01
                   0.1367200     -0.2854000E-01
                   0.1495400     -0.2898000E-01
                   0.1624400     -0.2934000E-01
                   0.1754400     -0.2961000E-01
                   0.1885300     -0.2982000E-01
                   0.2016600     -0.2998000E-01
                   0.2148300     -0.3010000E-01
                   0.2280400     -0.3016000E-01
                   0.2413100     -0.3019000E-01
                   0.2546100     -0.3019000E-01
                   0.2679000     -0.3016000E-01
                   0.2812100     -0.3010000E-01
                   0.2945500     -0.3001000E-01
                   0.3079100     -0.2990000E-01
                   0.3213100     -0.2977000E-01
                   0.3347200     -0.2963000E-01
                   0.3481300     -0.2948000E-01
                   0.3615300     -0.2932000E-01
                   0.3748900     -0.2914000E-01
                   0.3882600     -0.2894000E-01
                   0.4016600     -0.2872000E-01
                   0.4150900     -0.2848000E-01
                   0.4285400     -0.2824000E-01
                   0.4420000     -0.2801000E-01
                   0.4554700     -0.2777000E-01
                   0.4689500     -0.2754000E-01
                   0.4824400     -0.2730000E-01
                   0.4959200     -0.2707000E-01
                   0.5094000     -0.2684000E-01
                   0.5228700     -0.2660000E-01
                   0.5363300     -0.2636000E-01
                   0.5497900     -0.2612000E-01
                   0.5632400     -0.2587000E-01
                   0.5766800     -0.2561000E-01
                   0.5901100     -0.2534000E-01
                   0.6035400     -0.2507000E-01
                   0.6169600     -0.2478000E-01
                   0.6303900     -0.2448000E-01
                   0.6438000     -0.2417000E-01
                   0.6572200     -0.2386000E-01
                   0.6706400     -0.2352000E-01
                   0.6840600     -0.2318000E-01
                   0.6974900     -0.2283000E-01
                   0.7109100     -0.2247000E-01
                   0.7243400     -0.2210000E-01
                   0.7377600     -0.2173000E-01
                   0.7511600     -0.2136000E-01
                   0.7645400     -0.2098000E-01
                   0.7778800     -0.2059000E-01
                   0.7911800     -0.2021000E-01
                   0.8044300     -0.1984000E-01
                   0.8176300     -0.1950000E-01
                   0.8307700     -0.1925000E-01
                   0.8438800     -0.1914000E-01
                   0.8479601     -0.1916016E-01
                   0.8500000     -0.1918023E-01
                   0.8522023     -0.1932404E-01
                   0.8566052     -0.1963631E-01
                   0.8694939     -0.2076240E-01
                   0.8822318     -0.2209087E-01
                   0.8948468     -0.2347298E-01
                   0.9073240     -0.2480782E-01
                   0.9196488     -0.2599448E-01
                   0.9317823     -0.2701088E-01
                   0.9437264     -0.2781710E-01
                   0.9554309     -0.2842049E-01
                   0.9668047     -0.2883632E-01
                   0.9775467     -0.2907885E-01
                   0.9870615     -0.2923703E-01
                   0.9949222     -0.2942869E-01
                    1.000547     -0.2968340E-01 ];
     
    % non-dimensional airfoil coordinates, delta = 8 degree
    pp8 = [      1.00110    -0.02030
                 0.99558    -0.01945
                 0.98816    -0.01810
                 0.97965    -0.01631
                 0.97020    -0.01405
                 0.96004    -0.01135
                 0.94942    -0.00828
                 0.93857    -0.00489
                 0.92767    -0.00124
                 0.91681     0.00265
                 0.90604     0.00674
                 0.89535     0.01104
                 0.88473     0.01556
                 0.87409     0.02026
                 0.86335     0.02479
                 0.85894     0.02648
                 0.85444     0.02816
                 0.84995     0.02982
                 0.84612     0.03123
                 0.83442     0.03557
                 0.82241     0.04008
                 0.81033     0.04460
                 0.79843     0.04897
                 0.78671     0.05312
                 0.77512     0.05705
                 0.76362     0.06075
                 0.75216     0.06420
                 0.74070     0.06743
                 0.72918     0.07043
                 0.71757     0.07323
                 0.70583     0.07585
                 0.69393     0.07830
                 0.68191     0.08059
                 0.66978     0.08273
                 0.65756     0.08474
                 0.64527     0.08660
                 0.63291     0.08833
                 0.62050     0.08992
                 0.60803     0.09139
                 0.59552     0.09272
                 0.58297     0.09394
                 0.57037     0.09503
                 0.55773     0.09600
                 0.54507     0.09686
                 0.53237     0.09761
                 0.51964     0.09825
                 0.50688     0.09879
                 0.49411     0.09922
                 0.48131     0.09956
                 0.46850     0.09979
                 0.45567     0.09993
                 0.44284     0.09997
                 0.43000     0.09991
                 0.41717     0.09976
                 0.40433     0.09951
                 0.39150     0.09917
                 0.37868     0.09873
                 0.36586     0.09820
                 0.35306     0.09757
                 0.34027     0.09684
                 0.32751     0.09601
                 0.31477     0.09508
                 0.30204     0.09405
                 0.28935     0.09291
                 0.27669     0.09166
                 0.26405     0.09031
                 0.25146     0.08884
                 0.23892     0.08726
                 0.22642     0.08556
                 0.21397     0.08374
                 0.20158     0.08180
                 0.18925     0.07973
                 0.17701     0.07752
                 0.16484     0.07518
                 0.15276     0.07269
                 0.14079     0.07006
                 0.12896     0.06729
                 0.11728     0.06436
                 0.10581     0.06128
                 0.09459     0.05804
                 0.08370     0.05467
                 0.07324     0.05116
                 0.06334     0.04755
                 0.05412     0.04388
                 0.04574     0.04024
                 0.03834     0.03671
                 0.03198     0.03339
                 0.02663     0.03032
                 0.02217     0.02751
                 0.01846     0.02496
                 0.01536     0.02263
                 0.01276     0.02048
                 0.01057     0.01850
                 0.00872     0.01665
                 0.00713     0.01493
                 0.00578     0.01330
                 0.00463     0.01177
                 0.00364     0.01032
                 0.00281     0.00893
                 0.00210     0.00762
                 0.00151     0.00635
                 0.00103     0.00515
                 0.00064     0.00399
                 0.00035     0.00288
                 0.00015     0.00181
                 0.00004     0.00079
                 0.00000    -0.00020
                 0.00012    -0.00118
                 0.00036    -0.00220
                 0.00068    -0.00324
                 0.00109    -0.00431
                 0.00160    -0.00540
                 0.00223    -0.00651
                 0.00300    -0.00762
                 0.00391    -0.00872
                 0.00499    -0.00980
                 0.00626    -0.01084
                 0.00774    -0.01183
                 0.00942    -0.01279
                 0.01135    -0.01372
                 0.01355    -0.01464
                 0.01608    -0.01554
                 0.01901    -0.01646
                 0.02246    -0.01738
                 0.02656    -0.01833
                 0.03152    -0.01932
                 0.03755    -0.02038
                 0.04489    -0.02149
                 0.05365    -0.02263
                 0.06372    -0.02376
                 0.07480    -0.02482
                 0.08659    -0.02578
                 0.09880    -0.02663
                 0.11129    -0.02736
                 0.12396    -0.02800
                 0.13672    -0.02854
                 0.14954    -0.02898
                 0.16244    -0.02934
                 0.17544    -0.02961
                 0.18853    -0.02982
                 0.20166    -0.02998
                 0.21483    -0.03010
                 0.22804    -0.03016
                 0.24131    -0.03019
                 0.25461    -0.03019
                 0.26790    -0.03016
                 0.28121    -0.03010
                 0.29455    -0.03001
                 0.30791    -0.02990
                 0.32131    -0.02977
                 0.33472    -0.02963
                 0.34813    -0.02948
                 0.36153    -0.02932
                 0.37489    -0.02914
                 0.38826    -0.02894
                 0.40166    -0.02872
                 0.41509    -0.02848
                 0.42854    -0.02824
                 0.44200    -0.02801
                 0.45547    -0.02777
                 0.46895    -0.02754
                 0.48244    -0.02730
                 0.49592    -0.02707
                 0.50940    -0.02684
                 0.52287    -0.02660
                 0.53633    -0.02636
                 0.54979    -0.02612
                 0.56324    -0.02587
                 0.57668    -0.02561
                 0.59011    -0.02534
                 0.60354    -0.02507
                 0.61696    -0.02478
                 0.63039    -0.02448
                 0.64380    -0.02417
                 0.65722    -0.02386
                 0.67064    -0.02352
                 0.68406    -0.02318
                 0.69749    -0.02283
                 0.71091    -0.02247
                 0.72434    -0.02210
                 0.73776    -0.02173
                 0.75116    -0.02136
                 0.76454    -0.02098
                 0.77788    -0.02059
                 0.79118    -0.02021
                 0.80443    -0.01984
                 0.81763    -0.01950
                 0.83077    -0.01925
                 0.84388    -0.01914
                 0.84998    -0.01918
                 0.85662    -0.01929
                 0.86955    -0.01974
                 0.88234    -0.02040
                 0.89501    -0.02112
                 0.90754    -0.02180
                 0.91991    -0.02234
                 0.93208    -0.02272
                 0.94405    -0.02290
                 0.95577    -0.02289
                 0.96715    -0.02271
                 0.97789    -0.02239
                 0.98740    -0.02205
                 0.99526    -0.02183
                 1.00089    -0.02179 ];
     
    % non-dimensional airfoil coordinates, delta = -4 degree
    pm4 = [    0.9998908      0.1149175E-01
               0.9943163      0.1119401E-01
               0.9867704      0.1097312E-01
               0.9780571      0.1096469E-01
               0.9683380      0.1122603E-01
               0.9578233      0.1176339E-01
               0.9467836      0.1258184E-01
               0.9354488      0.1365710E-01
               0.9240188      0.1497539E-01
               0.9125847      0.1657504E-01
               0.9011959      0.1843504E-01
               0.8898737      0.2060505E-01
               0.8786087      0.2311526E-01
               0.8673828      0.2606615E-01
               0.8633886      0.2724071E-01
               0.8475047      0.3218146E-01
               0.8356883      0.3623946E-01
               0.8236214      0.4062826E-01
               0.8115245      0.4511782E-01
               0.7995977      0.4945803E-01
               0.7878512      0.5359877E-01
               0.7762448      0.5750989E-01
               0.7647285      0.6119131E-01
               0.7532523      0.6464293E-01
               0.7417760      0.6786468E-01
               0.7302496      0.7086652E-01
               0.7186230      0.7366841E-01
               0.7068662      0.7628033E-01
               0.6949591      0.7873230E-01
               0.6829118      0.8102435E-01
               0.6707744      0.8316652E-01
               0.6585368      0.8516882E-01
               0.6462290      0.8702125E-01
               0.6338511      0.8874384E-01
               0.6214231      0.9032657E-01
               0.6089350      0.9178946E-01
               0.5964068      0.9311249E-01
               0.5838386      0.9432569E-01
               0.5712202      0.9540902E-01
               0.5585618      0.9637248E-01
               0.5458832      0.9722609E-01
               0.5331647      0.9796984E-01
               0.5204160      0.9860371E-01
               0.5076373      0.9913771E-01
               0.4948485      0.9956183E-01
               0.4820297      0.9989608E-01
               0.4692008      0.1001204    
               0.4563519      0.1002549    
               0.4435030      0.1002895    
               0.4306441      0.1002241    
               0.4177951      0.1000689    
               0.4049361      0.9981367E-01
               0.3920871      0.9946857E-01
               0.3792481      0.9902352E-01
               0.3664091      0.9848853E-01
               0.3535902      0.9785359E-01
               0.3407812      0.9711868E-01
               0.3280022      0.9628380E-01
               0.3152433      0.9534894E-01
               0.3024944      0.9431409E-01
               0.2897855      0.9316924E-01
               0.2771066      0.9191437E-01
               0.2644478      0.9055950E-01
               0.2518390      0.8908458E-01
               0.2392803      0.8749964E-01
               0.2267617      0.8579465E-01
               0.2142931      0.8396960E-01
               0.2018846      0.8202448E-01
               0.1895362      0.7994929E-01
               0.1772779      0.7773399E-01
               0.1650897      0.7538861E-01
               0.1529916      0.7289310E-01
               0.1410037      0.7025748E-01
               0.1291560      0.6748174E-01
               0.1174585      0.6454586E-01
               0.1059714      0.6145985E-01
               0.9473456E-01  0.5821368E-01
               0.8382825E-01  0.5483742E-01
               0.7335258E-01  0.5132104E-01
               0.6343774E-01  0.4770462E-01
               0.5420392E-01  0.4402821E-01
               0.4581135E-01  0.4038196E-01
               0.3840026E-01  0.3684598E-01
               0.3203072E-01  0.3352043E-01
               0.2667269E-01  0.3044536E-01
               0.2220600E-01  0.2763076E-01
               0.1849044E-01  0.2507662E-01
               0.1538579E-01  0.2274287E-01
               0.1278189E-01  0.2058942E-01
               0.1058860E-01  0.1860627E-01
               0.8735824E-02  0.1675334E-01
               0.7143439E-02  0.1503063E-01
               0.5791413E-02  0.1339807E-01
               0.4639687E-02  0.1186568E-01
               0.3648202E-02  0.1041342E-01
               0.2816956E-02  0.9021268E-02
               0.2105891E-02  0.7709242E-02
               0.1515006E-02  0.6437285E-02
               0.1034285E-02  0.5235441E-02
               0.6437001E-03  0.4073665E-02
               0.3532649E-03  0.2961971E-02
               0.1529648E-03  0.1890344E-02
               0.4279982E-04  0.8687993E-03
               0.2739862E-05 -0.1226956E-03
               0.1229212E-03 -0.1104180E-02
               0.3632838E-03 -0.2125732E-02
               0.6837674E-03 -0.3167321E-02
               0.1094387E-02 -0.4238962E-02
               0.1605158E-02 -0.5330640E-02
               0.2236110E-02 -0.6442358E-02
               0.3007274E-02 -0.7554085E-02
               0.3918649E-02 -0.8655808E-02
               0.5000281E-02 -0.9737515E-02
               0.6272201E-02 -0.1077918E-01
               0.7754438E-02 -0.1177078E-01
               0.9436977E-02 -0.1273235E-01
               0.1136989E-01 -0.1366390E-01
               0.1357322E-01 -0.1458545E-01
               0.1610704E-01 -0.1548700E-01
               0.1904147E-01 -0.1640862E-01
               0.2249669E-01 -0.1733028E-01
               0.2660289E-01 -0.1828205E-01
               0.3157039E-01 -0.1927395E-01
               0.3760951E-01 -0.2033606E-01
               0.4496061E-01 -0.2144838E-01
               0.5373386E-01 -0.2259089E-01
               0.6381910E-01 -0.2372355E-01
               0.7491586E-01 -0.2478624E-01
               0.8672371E-01 -0.2574892E-01
               0.9895220E-01 -0.2660155E-01
               0.1114611     -0.2733409E-01
               0.1241503     -0.2797660E-01
               0.1369296     -0.2851906E-01
               0.1497691     -0.2896146E-01
               0.1626886     -0.2932385E-01
               0.1757084     -0.2959622E-01
               0.1888182     -0.2980861E-01
               0.2019682     -0.2997105E-01
               0.2151582     -0.3009355E-01
               0.2283882     -0.3015609E-01
               0.2416784     -0.3018872E-01
               0.2549986     -0.3019145E-01
               0.2683089     -0.3016428E-01
               0.2816391     -0.3010721E-01
               0.2949995     -0.3002026E-01
               0.3083798     -0.2991345E-01
               0.3218003     -0.2978679E-01
               0.3352307     -0.2965029E-01
               0.3486612     -0.2950396E-01
               0.3620817     -0.2934781E-01
               0.3754621     -0.2917182E-01
               0.3888526     -0.2897602E-01
               0.4022731     -0.2876041E-01
               0.4157237     -0.2852501E-01
               0.4291943     -0.2828987E-01
               0.4426750     -0.2806499E-01
               0.4561657     -0.2783036E-01
               0.4696664     -0.2760603E-01
               0.4831772     -0.2737198E-01
               0.4966780     -0.2714824E-01
               0.5101788     -0.2692480E-01
               0.5236696     -0.2669167E-01
               0.5371504     -0.2645888E-01
               0.5506313     -0.2622643E-01
               0.5641021     -0.2598433E-01
               0.5775630     -0.2573259E-01
               0.5910139     -0.2547122E-01
               0.6044648     -0.2521027E-01
               0.6179058     -0.2492970E-01
               0.6313567     -0.2463958E-01
               0.6447877     -0.2433989E-01
               0.6582287     -0.2404069E-01
               0.6716698     -0.2371195E-01
               0.6851109     -0.2338374E-01
               0.6985621     -0.2304607E-01
               0.7120033     -0.2269894E-01
               0.7254545     -0.2234239E-01
               0.7388958     -0.2197644E-01
               0.7523172     -0.2160635E-01
               0.7657088     -0.2122111E-01
               0.7790706     -0.2083077E-01
               0.7923925     -0.2042660E-01
               0.8056651     -0.1999282E-01
               0.8188790     -0.1948586E-01
               0.8320237     -0.1884947E-01
               0.8451004     -0.1800990E-01
               0.8492604     -0.1768847E-01
               0.8513343     -0.1751716E-01
               0.8523662     -0.1742913E-01
               0.8544344     -0.1724711E-01
               0.8579869     -0.1691687E-01
               0.8708366     -0.1555113E-01
               0.8835590     -0.1397121E-01
               0.8961453     -0.1224447E-01
               0.9085746     -0.1040476E-01
               0.9208168     -0.8446835E-02
               0.9328319     -0.6347912E-02
               0.9445997     -0.4116691E-02
               0.9561005     -0.1732257E-02
               0.9672136      0.7680045E-03
               0.9776757      0.3249460E-02
               0.9869310      0.5507892E-02
               0.9945939      0.7322156E-02
                1.000109      0.8495174E-02 ];
            
    % non-dimensional airfoil coordinates, delta = 0 degree
    pp0 = [     1.000004      0.7510388E-03
               0.9944213      0.8323829E-03
               0.9868917      0.1132769E-02
               0.9782153      0.1722059E-02
               0.9685412      0.2642308E-02
               0.9581026      0.3899729E-02
               0.9471554      0.5468443E-02
               0.9359415      0.7313008E-02
               0.9246385      0.9411726E-02
               0.9133461      0.1175533E-01
               0.9021137      0.1434330E-01
               0.8909514      0.1718171E-01
               0.8798422      0.2028144E-01
               0.8687349      0.2365970E-01
               0.8575438      0.2733555E-01
               0.8461494      0.3132233E-01
               0.8344295      0.3560499E-01
               0.8224101      0.4008443E-01
               0.8103285      0.4458113E-01
               0.7984198      0.4893141E-01
               0.7866925      0.5307842E-01
               0.7751011      0.5700231E-01
               0.7636012      0.6069385E-01
               0.7521443      0.6415267E-01
               0.7406842      0.6738264E-01
               0.7291731      0.7039306E-01
               0.7175638      0.7319924E-01
               0.7058195      0.7582082E-01
               0.6939269      0.7827650E-01
               0.6819043      0.8057796E-01
               0.6697764      0.8273019E-01
               0.6575605      0.8473731E-01
               0.6452699      0.8660297E-01
               0.6329142      0.8833086E-01
               0.6205006      0.8992464E-01
               0.6080350      0.9138785E-01
               0.5955221      0.9272394E-01
               0.5829654      0.9393634E-01
               0.5703687      0.9502839E-01
               0.5577350      0.9600322E-01
               0.5450670      0.9686395E-01
               0.5323675      0.9761362E-01
               0.5196392      0.9825496E-01
               0.5068844      0.9879081E-01
               0.4941066      0.9922375E-01
               0.4813093      0.9955592E-01
               0.4684958      0.9978930E-01
               0.4556704      0.9992550E-01
               0.4428385      0.9996554E-01
               0.4300036      0.9990968E-01
               0.4171675      0.9975815E-01
               0.4043324      0.9951120E-01
               0.3915008      0.9916887E-01
               0.3786756      0.9873102E-01
               0.3658604      0.9819717E-01
               0.3530589      0.9756640E-01
               0.3402743      0.9683746E-01
               0.3275092      0.9600871E-01
               0.3147650      0.9507846E-01
               0.3020440      0.9404513E-01
               0.2893495      0.9290697E-01
               0.2766850      0.9166197E-01
               0.2640542      0.9030793E-01
               0.2514625      0.8884243E-01
               0.2389152      0.8726233E-01
               0.2264151      0.8556409E-01
               0.2139669      0.8374456E-01
               0.2015775      0.8180045E-01
               0.1892549      0.7972782E-01
               0.1770061      0.7752216E-01
               0.1648385      0.7517886E-01
               0.1527623      0.7269387E-01
               0.1407934      0.7006387E-01
               0.1289558      0.6728615E-01
               0.1172808      0.6435796E-01
               0.1058072      0.6127710E-01
               0.9458852E-01  0.5804495E-01
               0.8370028E-01  0.5466840E-01
               0.7323995E-01  0.5116209E-01
               0.6333516E-01  0.4755346E-01
               0.5411575E-01  0.4388433E-01
               0.4573663E-01  0.4023644E-01
               0.3833860E-01  0.3670869E-01
               0.3198246E-01  0.3338601E-01
               0.2662921E-01  0.3031787E-01
               0.2216715E-01  0.2751442E-01
               0.1845575E-01  0.2495968E-01
               0.1535972E-01  0.2262527E-01
               0.1276317E-01  0.2048061E-01
               0.1057277E-01  0.1849776E-01
               0.8715315E-02  0.1665287E-01
               0.7133770E-02  0.1492647E-01
               0.5783547E-02  0.1330285E-01
               0.4629333E-02  0.1176971E-01
               0.3644196E-02  0.1031633E-01
               0.2806577E-02  0.8933991E-02
               0.2099780E-02  0.7615475E-02
               0.1510067E-02  0.6354939E-02
               0.1025972E-02  0.5148004E-02
               0.6409803E-03  0.3990650E-02
               0.3479831E-03  0.2879272E-02
               0.1477391E-03  0.1812226E-02
               0.3566005E-04  0.7901503E-03
               0.3079302E-05 -0.1989307E-03
               0.1219135E-03 -0.1182624E-02
               0.3592163E-03 -0.2197354E-02
               0.6751702E-03 -0.3241740E-02
               0.1085055E-02 -0.4312452E-02
               0.1599949E-02 -0.5403584E-02
               0.2233267E-02 -0.6508000E-02
               0.2999652E-02 -0.7616093E-02
               0.3914197E-02 -0.8717124E-02
               0.4992871E-02 -0.9798776E-02
               0.6261170E-02 -0.1083733E-01
               0.7735789E-02 -0.1182736E-01
               0.9422698E-02 -0.1278524E-01
               0.1134773E-01 -0.1371824E-01
               0.1354815E-01 -0.1463543E-01
               0.1607811E-01 -0.1554484E-01
               0.1901354E-01 -0.1645549E-01
               0.2246020E-01 -0.1737805E-01
               0.2656417E-01 -0.1832662E-01
               0.3151931E-01 -0.1932203E-01
               0.3755317E-01 -0.2037804E-01
               0.4489227E-01 -0.2148913E-01
               0.5364994E-01 -0.2263266E-01
               0.6371532E-01 -0.2376115E-01
               0.7480151E-01 -0.2481898E-01
               0.8658998E-01 -0.2577865E-01
               0.9880197E-01 -0.2662770E-01
               0.1112892     -0.2736311E-01
               0.1239628     -0.2799999E-01
               0.1367226     -0.2854106E-01
               0.1495383     -0.2898464E-01
               0.1624375     -0.2933533E-01
               0.1754402     -0.2960973E-01
               0.1885273     -0.2982311E-01
               0.2016633     -0.2998429E-01
               0.2148282     -0.3009521E-01
               0.2280364     -0.3015862E-01
               0.2413120     -0.3018504E-01
               0.2546113     -0.3018585E-01
               0.2679017     -0.3015620E-01
               0.2812092     -0.3009518E-01
               0.2945458     -0.3000687E-01
               0.3079126     -0.2989654E-01
               0.3213082     -0.2976976E-01
               0.3347218     -0.2963118E-01
               0.3481344     -0.2948293E-01
               0.3615263     -0.2932211E-01
               0.3748926     -0.2914308E-01
               0.3882593     -0.2894069E-01
               0.4016569     -0.2871903E-01
               0.4150876     -0.2848492E-01
               0.4285406     -0.2824496E-01
               0.4420042     -0.2800548E-01
               0.4554732     -0.2776951E-01
               0.4689505     -0.2753661E-01
               0.4824353     -0.2730471E-01
               0.4959192     -0.2707239E-01
               0.5093975     -0.2683871E-01
               0.5228692     -0.2660254E-01
               0.5363336     -0.2636269E-01
               0.5497901     -0.2611798E-01
               0.5632389     -0.2586722E-01
               0.5766800     -0.2560919E-01
               0.5901139     -0.2534275E-01
               0.6035417     -0.2506681E-01
               0.6169648     -0.2478050E-01
               0.6303852     -0.2448324E-01
               0.6438045     -0.2417479E-01
               0.6572238     -0.2385517E-01
               0.6706439     -0.2352449E-01
               0.6840649     -0.2318297E-01
               0.6974875     -0.2283083E-01
               0.7109120     -0.2246856E-01
               0.7243365     -0.2209686E-01
               0.7377551     -0.2171605E-01
               0.7511579     -0.2132510E-01
               0.7645340     -0.2092126E-01
               0.7778739     -0.2049991E-01
               0.7911712     -0.2005527E-01
               0.8044212     -0.1958111E-01
               0.8176161     -0.1907102E-01
               0.8307441     -0.1851716E-01
               0.8437934     -0.1790989E-01
               0.8567560     -0.1723808E-01
               0.8696285     -0.1649049E-01
               0.8824042     -0.1565728E-01
               0.8950592     -0.1472877E-01
               0.9075632     -0.1369201E-01
               0.9198851     -0.1253094E-01
               0.9319953     -0.1122707E-01
               0.9438722     -0.9762219E-02
               0.9554825     -0.8128894E-02
               0.9667263     -0.6353886E-02
               0.9773151     -0.4545288E-02
               0.9866848     -0.2882472E-02
               0.9944363     -0.1570340E-02
                1.000009     -0.7510388E-03 ];
            
    % non-dimensional airfoil coordinates, delta = 24 degree
    pp24 = [  0.9944995     -0.6184762E-01
               0.9894325     -0.5950262E-01
               0.9826761     -0.5616563E-01
               0.9749895     -0.5209828E-01
               0.9665261     -0.4732278E-01
               0.9575014     -0.4192831E-01
               0.9481387     -0.3604259E-01
               0.9386445     -0.2979639E-01
               0.9291723     -0.2328177E-01
               0.9198094     -0.1654775E-01
               0.9106007     -0.9614895E-02
               0.9015580     -0.2481762E-02
               0.8926700      0.4868501E-02
               0.8838970      0.1247244E-01
               0.8777751      0.1782497E-01
               0.8575438      0.2733555E-01
               0.8461494      0.3132233E-01
               0.8344295      0.3560499E-01
               0.8224101      0.4008443E-01
               0.8103285      0.4458113E-01
               0.7984198      0.4893141E-01
               0.7866925      0.5307842E-01
               0.7751011      0.5700231E-01
               0.7636012      0.6069385E-01
               0.7521443      0.6415267E-01
               0.7406842      0.6738264E-01
               0.7291731      0.7039306E-01
               0.7175638      0.7319924E-01
               0.7058195      0.7582082E-01
               0.6939269      0.7827650E-01
               0.6819043      0.8057796E-01
               0.6697764      0.8273019E-01
               0.6575605      0.8473731E-01
               0.6452699      0.8660297E-01
               0.6329142      0.8833086E-01
               0.6205006      0.8992464E-01
               0.6080350      0.9138785E-01
               0.5955221      0.9272394E-01
               0.5829654      0.9393634E-01
               0.5703687      0.9502839E-01
               0.5577350      0.9600322E-01
               0.5450670      0.9686395E-01
               0.5323675      0.9761362E-01
               0.5196392      0.9825496E-01
               0.5068844      0.9879081E-01
               0.4941066      0.9922375E-01
               0.4813093      0.9955592E-01
               0.4684958      0.9978930E-01
               0.4556704      0.9992550E-01
               0.4428385      0.9996554E-01
               0.4300036      0.9990968E-01
               0.4171675      0.9975815E-01
               0.4043324      0.9951120E-01
               0.3915008      0.9916887E-01
               0.3786756      0.9873102E-01
               0.3658604      0.9819717E-01
               0.3530589      0.9756640E-01
               0.3402743      0.9683746E-01
               0.3275092      0.9600871E-01
               0.3147650      0.9507846E-01
               0.3020440      0.9404513E-01
               0.2893495      0.9290697E-01
               0.2766850      0.9166197E-01
               0.2640542      0.9030793E-01
               0.2514625      0.8884243E-01
               0.2389152      0.8726233E-01
               0.2264151      0.8556409E-01
               0.2139669      0.8374456E-01
               0.2015775      0.8180045E-01
               0.1892549      0.7972782E-01
               0.1770061      0.7752216E-01
               0.1648385      0.7517886E-01
               0.1527623      0.7269387E-01
               0.1407934      0.7006387E-01
               0.1289558      0.6728615E-01
               0.1172808      0.6435796E-01
               0.1058072      0.6127710E-01
               0.9458852E-01  0.5804495E-01
               0.8370028E-01  0.5466840E-01
               0.7323995E-01  0.5116209E-01
               0.6333516E-01  0.4755346E-01
               0.5411575E-01  0.4388433E-01
               0.4573663E-01  0.4023644E-01
               0.3833860E-01  0.3670869E-01
               0.3198246E-01  0.3338601E-01
               0.2662921E-01  0.3031787E-01
               0.2216715E-01  0.2751442E-01
               0.1845575E-01  0.2495968E-01
               0.1535972E-01  0.2262527E-01
               0.1276317E-01  0.2048061E-01
               0.1057277E-01  0.1849776E-01
               0.8715315E-02  0.1665287E-01
               0.7133770E-02  0.1492647E-01
               0.5783547E-02  0.1330285E-01
               0.4629333E-02  0.1176971E-01
               0.3644196E-02  0.1031633E-01
               0.2806577E-02  0.8933991E-02
               0.2099780E-02  0.7615475E-02
               0.1510067E-02  0.6354939E-02
               0.1025972E-02  0.5148004E-02
               0.6409803E-03  0.3990650E-02
               0.3479831E-03  0.2879272E-02
               0.1477391E-03  0.1812226E-02
               0.3566005E-04  0.7901503E-03
               0.3079302E-05 -0.1989307E-03
               0.1219135E-03 -0.1182624E-02
               0.3592163E-03 -0.2197354E-02
               0.6751702E-03 -0.3241740E-02
               0.1085055E-02 -0.4312452E-02
               0.1599949E-02 -0.5403584E-02
               0.2233267E-02 -0.6508000E-02
               0.2999652E-02 -0.7616093E-02
               0.3914197E-02 -0.8717124E-02
               0.4992871E-02 -0.9798776E-02
               0.6261170E-02 -0.1083733E-01
               0.7735789E-02 -0.1182736E-01
               0.9422698E-02 -0.1278524E-01
               0.1134773E-01 -0.1371824E-01
               0.1354815E-01 -0.1463543E-01
               0.1607811E-01 -0.1554484E-01
               0.1901354E-01 -0.1645549E-01
               0.2246020E-01 -0.1737805E-01
               0.2656417E-01 -0.1832662E-01
               0.3151931E-01 -0.1932203E-01
               0.3755317E-01 -0.2037804E-01
               0.4489227E-01 -0.2148913E-01
               0.5364994E-01 -0.2263266E-01
               0.6371532E-01 -0.2376115E-01
               0.7480151E-01 -0.2481898E-01
               0.8658998E-01 -0.2577865E-01
               0.9880197E-01 -0.2662770E-01
               0.1112892     -0.2736311E-01
               0.1239628     -0.2799999E-01
               0.1367226     -0.2854106E-01
               0.1495383     -0.2898464E-01
               0.1624375     -0.2933533E-01
               0.1754402     -0.2960973E-01
               0.1885273     -0.2982311E-01
               0.2016633     -0.2998429E-01
               0.2148282     -0.3009521E-01
               0.2280364     -0.3015862E-01
               0.2413120     -0.3018504E-01
               0.2546113     -0.3018585E-01
               0.2679017     -0.3015620E-01
               0.2812092     -0.3009518E-01
               0.2945458     -0.3000687E-01
               0.3079126     -0.2989654E-01
               0.3213082     -0.2976976E-01
               0.3347218     -0.2963118E-01
               0.3481344     -0.2948293E-01
               0.3615263     -0.2932211E-01
               0.3748926     -0.2914308E-01
               0.3882593     -0.2894069E-01
               0.4016569     -0.2871903E-01
               0.4150876     -0.2848492E-01
               0.4285406     -0.2824496E-01
               0.4420042     -0.2800548E-01
               0.4554732     -0.2776951E-01
               0.4689505     -0.2753661E-01
               0.4824353     -0.2730471E-01
               0.4959192     -0.2707239E-01
               0.5093975     -0.2683871E-01
               0.5228692     -0.2660254E-01
               0.5363336     -0.2636269E-01
               0.5497901     -0.2611798E-01
               0.5632389     -0.2586722E-01
               0.5766800     -0.2560919E-01
               0.5901139     -0.2534275E-01
               0.6035417     -0.2506681E-01
               0.6169648     -0.2478050E-01
               0.6303852     -0.2448324E-01
               0.6438045     -0.2417479E-01
               0.6572238     -0.2385517E-01
               0.6706439     -0.2352449E-01
               0.6840649     -0.2318297E-01
               0.6974875     -0.2283083E-01
               0.7109120     -0.2246856E-01
               0.7243365     -0.2209686E-01
               0.7377551     -0.2171605E-01
               0.7511579     -0.2132510E-01
               0.7645340     -0.2092126E-01
               0.7778739     -0.2049991E-01
               0.7911712     -0.2005527E-01
               0.8044212     -0.1958111E-01
               0.8176161     -0.1907102E-01
               0.8307441     -0.1851716E-01
               0.8563191     -0.2001728E-01
               0.8683828     -0.2457004E-01
               0.8803929     -0.2900521E-01
               0.8923315     -0.3330423E-01
               0.9041761     -0.3744294E-01
               0.9159050     -0.4139401E-01
               0.9274985     -0.4512853E-01
               0.9389444     -0.4862109E-01
               0.9502153     -0.5185131E-01
               0.9612090     -0.5480303E-01
               0.9716180     -0.5745764E-01
               0.9808539     -0.5974959E-01
               0.9884690     -0.6170371E-01
               0.9938931     -0.6322187E-01 ];
          
    if deltacase == 14
        pts = pp14;
        deltaref = 14.0 * pi/180;
        dtape = 80.0;
    elseif deltacase == 11
        pts = pp11;
        deltaref = 11.0 * pi/180;
        dtape = 81.0;
    elseif deltacase == 8
        pts = pp8;
        deltaref = 8.0 * pi/180;
        dtape = 82.5;
    elseif deltacase == 24
        pts = pp24;
        deltaref = 24.0 * pi/180;
        dtape = 79.0;
    elseif deltacase == -4
        pts = pm4;
        deltaref = -4.0 * pi/180;
        dtape = 84.0;
    elseif deltacase == 0
        pts = pp0;
        deltaref = 0.0;
        dtape = 82.0;
    end

    % nondimensional location of the fwd edge of lower side hinge tape
    [ptape, itape] = lower_side_lookup( pts, pts(end,:), dtape./500. );
    
    % locations markers in reference attitude alpha = 0
    b1pos = lower_side_lookup( pts, pts(end,:), 10./500. );
    b2pos = lower_side_lookup( pts(1:itape, :), ptape, 10./500. );
    b3pos = lower_side_lookup( pts(1:itape, :), ptape, 94.25/500. );
    
    % angles in reference configuration 
    rb23 = atan2(b2pos(:,2) - b3pos(:,2), b2pos(:,1) - b3pos(:,1));
    rb12 = atan2(b1pos(:,2) - b2pos(:,2), b1pos(:,1) - b2pos(:,1));
    dshift = deltaref + rb12;
    
    b1 = h5read(h5file, '/qsys/pos', [1,1], [Inf,3]);
    b2 = h5read(h5file, '/qsys/pos', [1,4], [Inf,3]);
    b3 = h5read(h5file, '/qsys/pos', [1,7], [Inf,3]);
    tq = h5read(h5file, '/qsys/time');
    
    alpha = rb23 - atan2(b2(:,3) - b3(:,3), b2(:,1) - b3(:,1));
    delta = dshift - atan2(b1(:,3) - b2(:,3), b1(:,1) - b2(:,1)) - alpha;
    
end

function [pos, idx] = lower_side_lookup(p, pref, dst)
% pos = lower_side_lookup14(p, dst)
% 
% Return non-dimensional location of the lower-side point with distance dst
% from the trailing edge, using non-dimensional airfoil coordinates in p.

     % distance from trailing edge
     n = size(p,1);
     dte = sqrt(sum((p - ones(n,1)*pref).^2, 2));
     
     % interpolate position
     i1 = find(dte>dst, 1, 'last');
     i2 = i1+1;
     s = (dst - dte(i1)) / (dte(i2) - dte(i1));
     pos = (1-s)*p(i1,:) + s*p(i2,:);
     idx = i2;

end